---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { getAssetPath, getCssPath, getJsPath, getImagePath } from '../utils/assetPath';

export interface Props {
  title: string;
  description?: string;
  keywords?: string;
  canonical?: string;
}

const { title= "Diseño Web Chile, Diseño páginas web Chile, Páginas Web Chile", description = "Diseño de páginas web en Chile para empresas de todos los tamaños. Más de 13 años de experiencia creando sitios web optimizados con SEO para atraer más clientes y potenciar tus servicios o productos", keywords, canonical } = Astro.props;

// Base URL for assets
const baseUrl = import.meta.env.BASE_URL || '';
---

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content={description}>
  {keywords && <meta name="keywords" content={keywords}>}
  
  <!-- Canonical URL for SEO -->
  {canonical && <link rel="canonical" href={canonical} />}

  <!-- Title & Favicon -->
  <title>{title}</title>
  <link rel="icon" type="image/x-icon" href={getAssetPath('/favicon.ico')}>
  <link rel="shortcut icon" href={getAssetPath('/favicon.ico')} type="image/x-icon">
  <link rel="apple-touch-icon" href={getAssetPath('/favicon.ico')}>

  <!-- Preconnect para reducir latencia -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://code.jivosite.com">
  <link rel="preconnect" href="https://node-ya-7.jivosite.com">
  
  <!-- Preload critical resources -->
  <link rel="preload" href={getJsPath('bootstrap.bundle.min.js')} as="script">
  <link rel="preload" href={getJsPath('swiper-bundle.min.js')} as="script">
  <link rel="preload" href={getCssPath('bootstrap.min.css')} as="style">
  
  <!-- Preload fuente crítica para LCP (título principal) -->
  <link rel="preload" href="https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hiA.woff2" as="font" type="font/woff2" crossorigin>
  
  <!-- CSS Crítico - Carga inmediata -->
  <link rel="stylesheet" href={getCssPath('bootstrap.min.css')}>
  <link rel="stylesheet" href={getCssPath('style.css')}>
  <link rel="stylesheet" href={getCssPath('custom-colors.css')}>
  
  <!-- CSS No crítico - Carga diferida -->
  <link rel="preload" href={getCssPath('animate.css')} as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="/assets/css/tabler-icons.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href={getCssPath('swiper-bundle.min.css')} as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href={getCssPath('hero-colors.css')} as="style" onload="this.onload=null;this.rel='stylesheet'">
  
  <!-- Fallback para navegadores sin JS -->
  <noscript>
    <link rel="stylesheet" href={getCssPath('animate.css')}>
    <link rel="stylesheet" href="/assets/css/tabler-icons.min.css">
    <link rel="stylesheet" href={getCssPath('swiper-bundle.min.css')}>
    <link rel="stylesheet" href={getCssPath('hero-colors.css')}>
  </noscript>
  
  <!-- Optimización font-display para reducir bloqueo de fuentes -->
  <style>
    @font-face {
      font-family: 'tabler-icons';
      src: url('/assets/fonts/tabler-icons.woff2?v3.31.0') format('woff2');
      font-display: swap;
      font-weight: normal;
      font-style: normal;
    }
    
    /* Font-display para Google Fonts */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap');
  </style>

  <!-- Schema Markup para SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "ProfessionalService",
  "name": "Diseño Páginas Chile",
  "alternateName": "DiseñoPaginas.cl",
  "image": "https://diseñopaginas.cl/assets/logo/disenopaginas.svg",
  "url": "https://diseñopaginas.cl",
  "telephone": "+56961765268",
  "email": "codigoraul@gmail.com",
  "address": {
    "@type": "PostalAddress",
    "addressCountry": "CL",
    "addressRegion": "Chile"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": -33.4489,
    "longitude": -70.6693
  },
  "areaServed": {
    "@type": "Country",
    "name": "Chile"
  },
  "priceRange": "$$",
  "description": "Diseño de páginas web profesionales en Chile. Sitios web rápidos, optimizados para SEO y responsive. Atendemos empresas en todo Chile.",
  "sameAs": [
    "https://web.facebook.com/PaginasChile",
    "https://www.instagram.com/disenopaginas/",
    "https://www.linkedin.com/in/raul-riquelme-69a16859/",
    "https://x.com/raulriquelme2",
    "https://pinterest.com/raulriquelme/"
  ],
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.9",
    "reviewCount": "127",
    "bestRating": "5",
    "worstRating": "1"
  },
  "hasOfferCatalog": {
    "@type": "OfferCatalog",
    "name": "Servicios de Diseño Web",
    "itemListElement": [
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Diseño de Páginas Web",
          "description": "Sitios web profesionales y optimizados para SEO"
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Landing Pages",
          "description": "Páginas de aterrizaje optimizadas para conversión"
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Tiendas Online",
          "description": "E-commerce profesional para vender en línea"
        }
      }
    ]
  }
}
</script>

</head>

<body>
  <!-- Preloader -->
  <div class="preloader" id="preloader">
    <div class="spinner-grow" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <!-- Header -->
  <Header />

  <!-- Main Content -->
  <main>
    <slot />
  </main>

  <!-- Footer -->
  <Footer />

  <!-- Scripts - Carga optimizada -->
  <script src={getJsPath('bootstrap.bundle.min.js')} defer></script>
  <script src={getJsPath('swiper-bundle.min.js')} defer></script>
  <script src={getJsPath('wow.min.js')} defer></script>
  <script src={getJsPath('active.js')} defer></script>
  
  <script>
    // Preloader
    window.addEventListener('load', function() {
      const preloader = document.getElementById('preloader');
      if (preloader) {
        preloader.style.display = 'none';
      }
    });
  </script>
  
  <!-- Jivosite Chat Widget -->
  <script src="//code.jivosite.com/widget/PgpmFYkQWG" async></script>
</body>
</html> 